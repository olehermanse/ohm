<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ohm</title>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">
    <style type="text/css">
* {
    margin: 0;
    padding: 0;
    font-family: 'Varela Round', Helvetica, Arial, Sans-Serif;
}

.sidebar {
    height: 100vh;
    min-height: 600px;
    width: 90px;
    background-color: #ECECEC;
    color: #4A4A4A;
    display: flex;
    flex-direction: column;
}

.sidebar_content {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.toolheader {
    flex: 0 1 auto;
    margin: auto;
    margin-top: 1em;
}

.toolbox {
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    margin: auto;
    margin-top: 1em;
    margin-bottom: 1em;
}

.tool {
    flex: 1 1 auto;
    width: 36;
    height: 36;
    display: flex;
    justify-content: center;
    align-items: center;
}

.tool_svg {
    width: 32;
    height: 32;
}

.tool_svg:hover {
    width: 36;
    height: 36;
    cursor: pointer;
}

body {
    background-color: #F2F2F2;
    display: flex;
    min-height: 100vh;
}

h1 {
    font-size: 1.5em;
}

#drawing {
    background-color: #FFFFFF;
    border: 2px;
    border-color: #4A4A4A;
    margin: 1em;
}

    </style>
    <script>
function initOhm() {
    var p = document.getElementById("drawing");
    p.onclick = drawClick;
    initGrid();
};

function createGridLine(x1, y1, x2, y2) {
    var drawing = document.getElementById("drawing");
    var line = document.createElementNS("http://www.w3.org/2000/svg", 'line');
    line.setAttribute("x1", "" + x1);
    line.setAttribute("y1", "" + y1);
    line.setAttribute("x2", "" + x2);
    line.setAttribute("y2", "" + y2);
    line.setAttribute("style", "stroke:rgb(200,200,200);stroke-width:0.4");
    drawing.appendChild(line);
}

function initGrid() {
    for (var x = 50; x <= 800; x += 50) {
        createGridLine(x, 0, x, 800);
    }
    for (var y = 50; y <= 800; y += 50) {
        createGridLine(0, y, 800, y);
    }
}

function roundToGrid(pos) {
    return Math.round(pos / 50) * 50;
}

function upload_tool() {
    console.log("upload");
}

function save_tool() {
    console.log("save");
}

function share_tool() {
    console.log("share");
}

function wire_tool() {
    console.log("wire");
}

function circle_tool() {
    console.log("circle");
}

function component_tool() {
    console.log("component");
}

function text_tool() {
    console.log("text");
}

function rectangle_tool() {
    console.log("rectangle");
}

function delete_tool() {
    console.log("delete");
}

function copy_tool() {
    console.log("copy");
}

function circleExists(x, y) {
    var drawing = document.getElementById("drawing");

    for (let element of drawing.children) {
        // console.log(element.tagName);
        if (element.tagName === "circle" &&
            element.getAttribute("cx") === x &&
            element.getAttribute("cy") === y &&
            element.getAttribute("r") === "10") {
            return true;
        }
    }
    return false;
}

function drawClick(event) {
    var x = "" + roundToGrid(event.offsetX);
    var y = "" + roundToGrid(event.offsetY);

    if (circleExists(x, y)) {
        return;
    }
    // console.log("X: " + x + " Y: " + y);
    var drawing = document.getElementById("drawing");
    var circle = document.createElementNS("http://www.w3.org/2000/svg", 'circle');
    circle.setAttribute("cx", x);
    circle.setAttribute("cy", y);
    circle.setAttribute("r", "10");
    circle.setAttribute("fill", "#000000");
    drawing.appendChild(circle);
}

    </script>
</head>

<body onload="initOhm();">
    <div class="sidebar">
        <div class="sidebar_content">
            <h1 class="toolheader">ohm</h1>
            <div class="toolbox">
                <div class="tool" onclick="upload_tool();"><svg class="tool_svg" data-feather="upload">Load</svg></div>
                <div class="tool" onclick="save_tool();"><svg class="tool_svg" data-feather="save">Save</svg></div>
                <div class="tool" onclick="share_tool();"><svg class="tool_svg" data-feather="external-link">Share</svg></div>
                <div class="tool" onclick="wire_tool();"><svg class="tool_svg" data-feather="edit-2">Wire</svg></div>
                <div class="tool" onclick="circle_tool();"><svg class="tool_svg" data-feather="circle">Circle</svg></div>
                <div class="tool" onclick="component_tool();"><svg class="tool_svg" data-feather="cpu">Component</svg></div>
                <div class="tool" onclick="text_tool();"><svg class="tool_svg" data-feather="type">Text</svg></div>
                <div class="tool" onclick="rectangle_tool();"><svg class="tool_svg" data-feather="square">Rectangle</svg></div>
                <div class="tool" onclick="delete_tool();"><svg class="tool_svg" data-feather="x">Delete</svg></div>
                <div class="tool" onclick="copy_tool();"><svg class="tool_svg" data-feather="copy">Copy</svg></div>
            </div>
        </div>
    </div>
    <svg id="drawing" width="600" height="600" version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>
</body>
<script>
feather.replace()

</script>

</html>
